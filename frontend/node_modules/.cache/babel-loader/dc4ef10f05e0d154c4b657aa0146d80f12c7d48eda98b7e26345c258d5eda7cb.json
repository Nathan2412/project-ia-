{"ast":null,"code":"import MovieCard from '@/components/MovieCard.vue';\nexport default {\n  name: 'MovieRecommendations',\n  components: {\n    MovieCard\n  },\n  data() {\n    return {\n      filters: {\n        contentType: 'all',\n        streamingService: '',\n        n: 10\n      }\n    };\n  },\n  created() {\n    this.loadDependencies();\n    this.getRecommendations();\n  },\n  methods: {\n    async loadDependencies() {\n      await this.$store.dispatch('fetchStreamingServices');\n    },\n    getRecommendations() {\n      this.$store.dispatch('fetchRecommendations', {\n        contentType: this.filters.contentType,\n        n: this.filters.n,\n        streamingService: this.filters.streamingService || null\n      });\n    },\n    truncateText(text, length) {\n      if (!text) return '';\n      if (text.length <= length) return text;\n      return text.substring(0, length) + '...';\n    },\n    checkIfInHistory(itemId, type) {\n      if (!this.$store.state.currentUser || !this.$store.state.currentUser.watch_history) {\n        return false;\n      }\n      return this.$store.state.currentUser.watch_history.some(item => item.id === itemId && item.content_type === type);\n    },\n    async addToHistory(item, type) {\n      try {\n        await this.$store.dispatch('addToHistory', {\n          id: item.id,\n          title: item.title || item.name,\n          poster_path: item.poster_path,\n          content_type: type,\n          rating: item.rating\n        });\n\n        // Notification de succès\n        this.$root.$refs.notifications.success(`\"${item.title || item.name}\" a été ajouté à votre historique!`);\n\n        // Rafraîchir les recommandations\n        setTimeout(() => this.getRecommendations(), 1000);\n      } catch (error) {\n        this.$root.$refs.notifications.error(\"Erreur lors de l'ajout à l'historique.\");\n        console.error(error);\n      }\n    },\n    // eslint-disable-next-line no-unused-vars\n    showItemDetails(item, type) {\n      // Afficher un dialogue modal avec plus de détails sur le film/série\n      // Pour une version ultérieure, on pourrait créer un modal ou une page détaillée\n      console.log('Afficher détails pour:', item);\n      this.$root.$refs.notifications.info(`Détails de \"${item.title || item.name}\" - Cette fonctionnalité sera disponible dans une prochaine version.`);\n    }\n  }\n};","map":{"version":3,"names":["MovieCard","name","components","data","filters","contentType","streamingService","n","created","loadDependencies","getRecommendations","methods","$store","dispatch","truncateText","text","length","substring","checkIfInHistory","itemId","type","state","currentUser","watch_history","some","item","id","content_type","addToHistory","title","poster_path","rating","$root","$refs","notifications","success","setTimeout","error","console","showItemDetails","log","info"],"sources":["/home/ubuntu/frontend/src/views/Recommendations.vue"],"sourcesContent":["<template>\n  <div class=\"recommendations\">\n    <h2 class=\"mb-4\">Recommandations pour vous</h2>\n    \n    <!-- Filters -->\n    <div class=\"card mb-4\">\n      <div class=\"card-body\">\n        <h5 class=\"card-title\">Filtres</h5>\n        <div class=\"row align-items-end\">\n          <div class=\"col-md-4\">\n            <div class=\"form-group\">\n              <label>Type de contenu</label>\n              <select v-model=\"filters.contentType\" class=\"form-select\">\n                <option value=\"all\">Films et Séries</option>\n                <option value=\"movies\">Films uniquement</option>\n                <option value=\"series\">Séries uniquement</option>\n              </select>\n            </div>\n          </div>\n          <div class=\"col-md-4\">\n            <div class=\"form-group\">\n              <label>Service de streaming</label>\n              <select v-model=\"filters.streamingService\" class=\"form-select\">\n                <option value=\"\">Tous les services</option>\n                <option v-for=\"service in $store.state.streamingServices\" :key=\"service\" :value=\"service\">\n                  {{ service.charAt(0).toUpperCase() + service.slice(1) }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <div class=\"col-md-2\">\n            <div class=\"form-group\">\n              <label>Nombre de résultats</label>\n              <input type=\"number\" v-model.number=\"filters.n\" min=\"1\" max=\"20\" class=\"form-control\">\n            </div>\n          </div>\n          <div class=\"col-md-2\">\n            <button @click=\"getRecommendations\" class=\"btn btn-primary w-100\">\n              Appliquer\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Loading state -->\n    <div v-if=\"$store.state.isLoading\" class=\"text-center py-5\">\n      <div class=\"spinner-border text-primary\" role=\"status\">\n        <span class=\"visually-hidden\">Chargement...</span>\n      </div>\n      <p class=\"mt-3\">Recherche de recommandations en cours...</p>\n    </div>\n    \n    <!-- Error state -->\n    <div v-else-if=\"$store.state.error\" class=\"alert alert-danger\">\n      {{ $store.state.error }}\n      <button @click=\"getRecommendations\" class=\"btn btn-outline-danger btn-sm ms-2\">Réessayer</button>\n    </div>\n    \n    <!-- No recommendations -->\n    <div v-else-if=\"$store.state.recommendations.length === 0\" class=\"text-center py-5\">\n      <div class=\"alert alert-info\">\n        <p>Aucune recommandation trouvée avec les critères actuels.</p>\n        <p>Essayez de modifier vos filtres ou vos préférences.</p>\n      </div>\n    </div>    <!-- Recommendations display -->\n    <div v-else class=\"row\">\n      <div v-for=\"(rec, index) in $store.state.recommendations\" :key=\"index\" class=\"col-md-4 mb-4\">\n        <MovieCard \n          :item=\"rec.item\" \n          :type=\"rec.type\" \n          :streaming-services=\"rec.streaming_services\"\n          :in-history=\"checkIfInHistory(rec.item.id, rec.type)\"\n          @add-to-history=\"addToHistory(rec.item, rec.type)\"\n          @show-details=\"showItemDetails(rec.item, rec.type)\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MovieCard from '@/components/MovieCard.vue';\n\nexport default {\n  name: 'MovieRecommendations',\n  components: {\n    MovieCard\n  },\n  data() {\n    return {\n      filters: {\n        contentType: 'all',\n        streamingService: '',\n        n: 10\n      }\n    };\n  },\n  created() {\n    this.loadDependencies();\n    this.getRecommendations();\n  },\n  methods: {\n    async loadDependencies() {\n      await this.$store.dispatch('fetchStreamingServices');\n    },\n    getRecommendations() {\n      this.$store.dispatch('fetchRecommendations', {\n        contentType: this.filters.contentType,\n        n: this.filters.n,\n        streamingService: this.filters.streamingService || null\n      });\n    },    truncateText(text, length) {\n      if (!text) return '';\n      if (text.length <= length) return text;\n      return text.substring(0, length) + '...';\n    },\n    checkIfInHistory(itemId, type) {\n      if (!this.$store.state.currentUser || !this.$store.state.currentUser.watch_history) {\n        return false;\n      }\n      return this.$store.state.currentUser.watch_history.some(item => \n        item.id === itemId && item.content_type === type\n      );\n    },\n    async addToHistory(item, type) {\n      try {\n        await this.$store.dispatch('addToHistory', {\n          id: item.id,\n          title: item.title || item.name,\n          poster_path: item.poster_path,\n          content_type: type,\n          rating: item.rating\n        });\n        \n        // Notification de succès\n        this.$root.$refs.notifications.success(\n          `\"${item.title || item.name}\" a été ajouté à votre historique!`\n        );\n        \n        // Rafraîchir les recommandations\n        setTimeout(() => this.getRecommendations(), 1000);\n      } catch (error) {\n        this.$root.$refs.notifications.error(\n          \"Erreur lors de l'ajout à l'historique.\"\n        );\n        console.error(error);\n      }\n    },\n    // eslint-disable-next-line no-unused-vars\n    showItemDetails(item, type) {\n      // Afficher un dialogue modal avec plus de détails sur le film/série\n      // Pour une version ultérieure, on pourrait créer un modal ou une page détaillée\n      console.log('Afficher détails pour:', item);\n      this.$root.$refs.notifications.info(\n        `Détails de \"${item.title || item.name}\" - Cette fonctionnalité sera disponible dans une prochaine version.`\n      );\n    }\n  }\n}\n</script>\n\n<style scoped>\n.poster-container {\n  height: 350px;\n  overflow: hidden;\n}\n\n.movie-poster {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.movie-poster-placeholder {\n  height: 350px;\n}\n\n.compatibility-score {\n  font-size: 0.9rem;\n  color: #6200ea;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}